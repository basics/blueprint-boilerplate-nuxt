import{a6 as S,a5 as I,z as w,S as l,B as M,a7 as v,a8 as j,b as z,a as O}from"./CSJaAcVl.js";async function P(t,e){return await N(e).catch(r=>(console.error("Failed to get image meta for "+e,r+""),{width:0,height:0,ratio:0}))}async function N(t){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((e,i)=>{const r=new Image;r.onload=()=>{const n={width:r.width,height:r.height,ratio:r.width/r.height};e(n)},r.onerror=n=>i(n),r.src=t})}function x(t){return e=>e?t[e]||e:t.missingValue}function D({formatter:t,keyMap:e,joinWith:i="/",valueMap:r}={}){t||(t=(s,o)=>`${s}=${o}`),e&&typeof e!="function"&&(e=x(e));const n=r||{};return Object.keys(n).forEach(s=>{typeof n[s]!="function"&&(n[s]=x(n[s]))}),(s={})=>Object.entries(s).filter(([a,c])=>typeof c<"u").map(([a,c])=>{const f=n[a];return typeof f=="function"&&(c=f(s[a])),a=typeof e=="function"?e(a):a,t(a,c)}).join(i)}function u(t=""){if(typeof t=="number")return t;if(typeof t=="string"&&t.replace("px","").match(/^\d+$/g))return Number.parseInt(t,10)}function E(t=""){if(t===void 0||!t.length)return[];const e=new Set;for(const i of t.split(" ")){const r=Number.parseInt(i.replace("x",""));r&&e.add(r)}return Array.from(e)}function R(t){if(t.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function U(t){const e={};if(typeof t=="string")for(const i of t.split(/[\s,]+/).filter(r=>r)){const r=i.split(":");r.length!==2?e["1px"]=r[0].trim():e[r[0].trim()]=r[1].trim()}else Object.assign(e,t);return e}function A(t){const e={options:t},i=(n,s={})=>$(e,n,s),r=(n,s={},o={})=>i(n,{...o,modifiers:S(s,o.modifiers||{})}).url;for(const n in t.presets)r[n]=(s,o,a)=>r(s,o,{...t.presets[n],...a});return r.options=t,r.getImage=i,r.getMeta=(n,s)=>C(e,n,s),r.getSizes=(n,s)=>V(e,n,s),e.$img=r,r}async function C(t,e,i){const r=$(t,e,{...i});return typeof r.getMeta=="function"?await r.getMeta():await P(t,r.url)}function $(t,e,i){if(e&&typeof e!="string")throw new TypeError(`input must be a string (received ${typeof e}: ${JSON.stringify(e)})`);if(!e||e.startsWith("data:"))return{url:e};const{provider:r,defaults:n}=H(t,i.provider||t.options.provider),s=L(t,i.preset);if(e=w(e)?e:I(e),!r.supportsAlias){for(const f in t.options.alias)if(e.startsWith(f)){const g=t.options.alias[f];g&&(e=l(g,e.slice(f.length)))}}if(r.validateDomains&&w(e)){const f=M(e).host;if(!t.options.domains.find(g=>g===f))return{url:e}}const o=S(i,s,n);o.modifiers={...o.modifiers};const a=o.modifiers.format;o.modifiers?.width&&(o.modifiers.width=u(o.modifiers.width)),o.modifiers?.height&&(o.modifiers.height=u(o.modifiers.height));const c=r.getImage(e,o,t);return c.format=c.format||a||"",c}function H(t,e){const i=t.options.providers[e];if(!i)throw new Error("Unknown provider: "+e);return i}function L(t,e){if(!e)return{};if(!t.options.presets[e])throw new Error("Unknown preset: "+e);return t.options.presets[e]}function V(t,e,i){const r=u(i.modifiers?.width),n=u(i.modifiers?.height),s=U(i.sizes),o=i.densities?.trim()?E(i.densities.trim()):t.options.densities;R(o);const a=r&&n?n/r:0,c=[],f=[];if(Object.keys(s).length>=1){for(const d in s){const h=_(d,String(s[d]),n,a,t);if(h!==void 0){c.push({size:h.size,screenMaxWidth:h.screenMaxWidth,media:`(max-width: ${h.screenMaxWidth}px)`});for(const m of o)f.push({width:h._cWidth*m,src:y(t,e,i,h,m)})}}F(c)}else for(const d of o){const h=Object.keys(s)[0];let m=h?_(h,String(s[h]),n,a,t):void 0;m===void 0&&(m={size:"",screenMaxWidth:0,_cWidth:i.modifiers?.width,_cHeight:i.modifiers?.height}),f.push({width:d,src:y(t,e,i,m,d)})}G(f);const g=f[f.length-1],p=c.length?c.map(d=>`${d.media?d.media+" ":""}${d.size}`).join(", "):void 0,b=p?"w":"x",W=f.map(d=>`${d.src} ${d.width}${b}`).join(", ");return{sizes:p,srcset:W,src:g?.src}}function _(t,e,i,r,n){const s=n.options.screens&&n.options.screens[t]||Number.parseInt(t),o=e.endsWith("vw");if(!o&&/^\d+$/.test(e)&&(e=e+"px"),!o&&!e.endsWith("px"))return;let a=Number.parseInt(e);if(!s||!a)return;o&&(a=Math.round(a/100*s));const c=r?Math.round(a*r):i;return{size:e,screenMaxWidth:s,_cWidth:a,_cHeight:c}}function y(t,e,i,r,n){return t.$img(e,{...i.modifiers,width:r._cWidth?r._cWidth*n:void 0,height:r._cHeight?r._cHeight*n:void 0},i)}function F(t){t.sort((i,r)=>i.screenMaxWidth-r.screenMaxWidth);let e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.media===e&&t.splice(i,1),e=r.media}for(let i=0;i<t.length;i++)t[i].media=t[i+1]?.media||""}function G(t){t.sort((i,r)=>i.width-r.width);let e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.width===e&&t.splice(i,1),e=r.width}}const T=D({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(t,e)=>v(t)+"_"+v(e)}),q=!0,B=!0,J=(t,{modifiers:e={},baseURL:i}={},r)=>{e.width&&e.height&&(e.resize=`${e.width}x${e.height}`,delete e.width,delete e.height);const n=T(e)||"_";return i||(i=l(r.options.nuxt.baseURL,"/_ipx")),{url:l(i,n,j(t).replace(/\/{2,}/g,"/"))}},Q=Object.freeze(Object.defineProperty({__proto__:null,getImage:J,supportsAlias:B,validateDomains:q},Symbol.toStringTag,{value:"Module"})),X={screens:{xs:576,sm:768,md:996,lg:1200,xl:1367,xxl:1600,"2xl":1536,default:320,xxs:480,"4k":1921},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp"],providers:{ipxStatic:{provider:Q,defaults:{}}}},Z=t=>{const e=O(),i=z();return i.$img||i._img||(i._img=A({...X,event:i.ssrContext?.event,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};export{u as p,Z as u};
